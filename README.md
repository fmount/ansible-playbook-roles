OpenVPN Ansible Playbook
========================

An ansible playbook to manage the basic system bootstrap and the provisioning of an OpenVPN server
service for your private VPS.

Prerequisite
====
Inside the ansible role, populate the path files/easy-rsa/keys with your keys generated by easy-rsa:

    ./build-ca
    ./build-key-server server
    ./build-dh

    openvpn --genkey --secret ta.key

and the files/easy-rsa/client with the client keys simply running:

    ./build-key client

An ansible task related to the OpenVPN installation is able to copy all generated keys on the
server.

The **group\_vars/all** file also provide some general variables like the hostname and the openvpn
server IP address.


Run the playbook
===
After the prereq steps, you are now able to run the ansible playbook in this way:

    ansible-playbook site.yml -i hosts --limit openvpn

specifying the inventory file (./hosts) and limiting the playbook to the openvpn role


Generate the Client
===

Once the playbook has finished its job, generate the client.ovpn using this conf:

	client
	dev tun
	proto udp
	remote your_server_ip 1194
	resolv-retry infinite
    remote-cert-tls server
    tls-auth ta.key 1
    nobind
	persist-key
	persist-tun
	comp-lzo
	verb 3
    cipher AES-256-CBC
	ca /path/to/ca.crt
	cert /path/to/client.crt
	key /path/to/client.key

Finally you can try to connect using the openvpn cli:

    openvpn --config /path/to/client.ovpn

and check your [ip address](https://duckduckgo.com/?q=what+is+my+ip)

TODO LIST
===

+ Conf a postfix to send fail2ban email alerts
+ httpd + web interface to read the openvpn logs and download client conf
